:root {
  --bg: #040812;
  --card: #081226;
  --muted: #9fb3d6;
  --text: #eaf2ff;
  --accent1: #4f8cff;
  --accent2: #8b5cf6;
  --success: #22c55e;
  --danger: #ef4444;
  --glass: rgba(255, 255, 255, 0.04);
  --chart-planned: #4f8cff;
  --chart-actual: #22c55e;
  --chart-background: rgba(255, 255, 255, 0.08);
}

body {
  margin: 0;
  font-family: 'Cairo', sans-serif;
  background: var(--bg);
  color: var(--text);
  direction: rtl;
  min-height: 100vh;
  line-height: 1.6;
  transition: background 0.3s ease, color 0.3s ease;
}

body.light {
  --bg: #f7f9fc;
  --card: #ffffff;
  --muted: #6b7280;
  --text: #09102a;
  --glass: rgba(15, 23, 42, 0.06);
  --chart-planned: #2563eb;
  --chart-actual: #16a34a;
  --chart-background: rgba(15, 23, 42, 0.08);
}

*,
*::before,
*::after {
  box-sizing: border-box;
}

a {
  color: inherit;
}

.dashboard-shell {
  width: min(1680px, 100%);
  margin: 0 auto;
  padding: 32px 40px 48px;
  display: grid;
  grid-template-rows: auto auto 1fr;
  gap: 24px;
}

@media (max-width: 1024px) {
  .dashboard-shell {
    padding: 24px;
  }
}

@media (max-width: 640px) {
  .dashboard-shell {
    padding: 16px;
    gap: 16px;
  }
}

.dashboard-header {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 32px;
  background: var(--card);
  border-radius: 24px;
  border: 1px solid var(--glass);
  padding: 20px 32px;
  box-shadow: 0 15px 45px rgba(4, 8, 18, 0.28);
}

@media (max-width: 920px) {
  .dashboard-header {
    grid-template-columns: 1fr;
    text-align: center;
    gap: 16px;
  }

  .logo-right,
  .logo-left {
    justify-self: center;
  }
}

.logo {
  height: 82px;
  width: auto;
  object-fit: contain;
  transition: transform 0.25s ease;
  filter: drop-shadow(0 10px 24px rgba(0, 0, 0, 0.25));
}

.logo:hover {
  transform: translateY(-4px) scale(1.03);
}

.dashboard-header-titles {
  display: grid;
  gap: 6px;
  justify-items: center;
}

.main-title {
  margin: 0;
  font-size: 28px;
  letter-spacing: 0.4px;
}

.subtitle {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--muted);
}

.dashboard-controls-bar {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: 24px;
  padding: 12px 24px;
  background: var(--card);
  border-radius: 20px;
  border: 1px solid var(--glass);
  box-shadow: 0 12px 30px rgba(4, 8, 18, 0.18);
}

@media (max-width: 820px) {
  .dashboard-controls-bar {
    grid-template-columns: 1fr;
    gap: 16px;
  }

  .dashboard-nav-controls {
    justify-content: space-between;
  }
}

.tabs,
.dashboard-tabs {
  display: inline-flex;
  gap: 12px;
  align-items: center;
}

.tab,
.dashboard-tab {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 18px;
  border-radius: 999px;
  border: 1px solid transparent;
  background: rgba(79, 140, 255, 0.12);
  color: var(--text);
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s ease;
}

.tab:hover,
.dashboard-tab:hover {
  background: rgba(79, 140, 255, 0.22);
}

.tab.active,
.dashboard-tab.active {
  background: linear-gradient(120deg, var(--accent1), var(--accent2));
  border-color: transparent;
  color: #fff;
  box-shadow: 0 8px 20px rgba(79, 140, 255, 0.25);
}

.dashboard-nav-controls {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 12px;
  flex-wrap: wrap;
}

.lastUpdate,
.dashboard-last-update {
  font-size: 14px;
  color: var(--muted);
  padding: 8px 14px;
  border-radius: 999px;
  border: 1px solid var(--glass);
  background: rgba(255, 255, 255, 0.02);
}

.btn {
  appearance: none;
  border: 1px solid var(--glass);
  border-radius: 999px;
  background: var(--card);
  color: var(--text);
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(79, 140, 255, 0.25);
  background: linear-gradient(120deg, rgba(79, 140, 255, 0.18), rgba(139, 92, 246, 0.18));
}

.btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.refresh-btn {
  background: linear-gradient(120deg, var(--success), #2ddf80);
  color: #fff;
  border: none;
}

.refresh-btn:hover:not(:disabled) {
  box-shadow: 0 12px 30px rgba(34, 197, 94, 0.3);
}

.clear-btn {
  background: linear-gradient(120deg, var(--danger), #f87171);
  color: #fff;
  border: none;
}

.dashboard-clear-button {
  justify-self: start;
}

.dashboard-main {
  display: grid;
  gap: 24px;
}


.dashboard-summary-view,
.dashboard-details-view {
  width: 100%;
}

.dashboard-summary-view {
  display: grid;
}

.dashboard-details-view {
  display: none;
}

.summary-grid {
  display: grid;
  gap: 24px;
  grid-template-columns: repeat(12, minmax(0, 1fr));
  grid-template-areas:
    'filters filters filters filters filters filters map map map map map map'
    'filters filters filters filters filters filters map map map map map map'
    'plan plan plan plan plan plan map map map map map map'
    'performance performance performance performance performance performance performance performance performance performance performance performance';
}

.summary-grid__filters {
  grid-area: filters;
}

.summary-grid__plan {
  grid-area: plan;
}

.summary-grid__map {
  grid-area: map;
}

.summary-grid__performance {
  grid-area: performance;
}

@media (max-width: 1280px) {
  .summary-grid {
    grid-template-columns: repeat(6, minmax(0, 1fr));
    grid-template-areas:
      'filters filters filters filters filters filters'
      'map map map map map map'
      'plan plan plan plan plan plan'
      'performance performance performance performance performance performance';
  }
}

@media (max-width: 720px) {
  .summary-grid {
    grid-template-columns: 1fr;
    grid-template-areas:
      'filters'
      'map'
      'plan'
      'performance';
    gap: 16px;
  }
}

.filters,
.dashboard-filters {
  background: var(--card);
  border-radius: 24px;
  border: 1px solid var(--glass);
  padding: 24px;
  display: grid;
  gap: 20px;
  box-shadow: 0 15px 38px rgba(4, 8, 18, 0.22);
}

.filter-group,
.dashboard-filter-group {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
  align-items: stretch;
}

.select {
  background: var(--card);
  color: var(--text);
  border: 1px solid var(--glass);
  border-radius: 14px;
  padding: 10px 14px;
  font-size: 14px;
  font-family: inherit;
  transition: border 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
}

.select:focus {
  outline: none;
  border-color: var(--accent1);
  box-shadow: 0 0 0 3px rgba(79, 140, 255, 0.25);
}

.dashboard-kpi-area {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
}

.grid {
  display: grid;
  gap: 16px;
}

.card {
  background: var(--card);
  border-radius: 24px;
  border: 1px solid var(--glass);
  padding: 24px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  box-shadow: 0 18px 40px rgba(4, 8, 18, 0.22);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 22px 48px rgba(79, 140, 255, 0.18);
}

.panel-header,
.dashboard-panel-header,
.chart-header,
.dashboard-performance-header,
.table-controls,
.dashboard-table-controls {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.dashboard-plan-actual-panel {
  min-height: 360px;
  justify-content: space-between;
}

.dashboard-plan-actual-canvas {
  width: 100% !important;
  height: 100% !important;
  min-height: 280px;
}

.dashboard-map-panel {
  position: relative;
  min-height: 480px;
}

.dashboard-map {
  width: 100%;
  height: 100%;
  min-height: 420px;
  border-radius: 20px;
  overflow: hidden;
  border: 1px solid var(--glass);
  background: rgba(255, 255, 255, 0.02);
}

.leaflet-popup-content-wrapper,
.leaflet-popup-tip {
  background: var(--card);
  color: var(--text);
}

.dashboard-performance-card {
  padding-bottom: 32px;
}

.dashboard-donut-area {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
}

.dashboard-gauge-area {
  display: none;
  margin-top: 16px;
}

.gauge-container {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 18px;
  padding: 24px;
}

.gauge-info {
  margin-top: 16px;
  display: flex;
  gap: 16px;
  justify-content: space-around;
}

.gauge-item {
  text-align: center;
  display: grid;
  gap: 6px;
}

.gauge-label {
  color: var(--muted);
  font-size: 13px;
}

.gauge-value {
  font-size: 18px;
  font-weight: 700;
}

.kpi {
  text-align: center;
  gap: 12px;
}

.kpi h3 {
  margin: 0;
  font-size: 16px;
  color: var(--muted);
}

.value {
  font-size: 24px;
  font-weight: 700;
  font-feature-settings: 'tnum';
}

.percentage {
  font-feature-settings: 'tnum';
  font-variant-numeric: tabular-nums;
}

.percentage.positive {
  color: var(--success);
}

.percentage.negative {
  color: var(--danger);
}

.details-grid {
  display: grid;
  grid-template-columns: repeat(12, minmax(0, 1fr));
  gap: 24px;
}

.details-grid__table {
  grid-column: 1 / -1;
}

.dashboard-table-card {
  padding: 24px;
}

.dashboard-table-filters {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

.dashboard-search-input {
  background: var(--card);
  color: var(--text);
  border: 1px solid var(--glass);
  border-radius: 14px;
  padding: 10px 14px;
  font-size: 14px;
  min-width: 200px;
}

.dashboard-table-scroll {
  margin-top: 16px;
  border-radius: 18px;
  overflow: auto;
  border: 1px solid var(--glass);
}

.dashboard-table-scroll table {
  width: 100%;
  border-collapse: collapse;
  min-width: 640px;
}

thead th {
  position: sticky;
  top: 0;
  background: var(--card);
  padding: 14px 16px;
  text-align: right;
  cursor: pointer;
  border-bottom: 1px solid var(--glass);
  font-weight: 700;
  transition: background 0.2s ease;
}

thead th:hover {
  background: rgba(79, 140, 255, 0.12);
}

td,
th {
  padding: 12px 16px;
  border-bottom: 1px solid var(--glass);
}

tbody tr:hover {
  background: rgba(79, 140, 255, 0.08);
}

.dashboard-table-footer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--muted);
}

.dashboard-error-message {
  background: rgba(239, 68, 68, 0.15);
  color: #fff;
  border-radius: 18px;
  padding: 16px 20px;
  border: 1px solid rgba(239, 68, 68, 0.3);
}

.loader,
.dashboard-loader {
  position: fixed;
  inset: 0;
  background: rgba(4, 8, 18, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.spinner,
.dashboard-spinner {
  width: 72px;
  height: 72px;
  border-radius: 50%;
  border: 8px solid rgba(255, 255, 255, 0.12);
  border-top-color: var(--accent1);
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@media (max-width: 480px) {
  .dashboard-nav-controls {
    justify-content: center;
  }

  .dashboard-last-update {
    width: 100%;
    text-align: center;
  }

  .dashboard-search-input {
    width: 100%;
    min-width: auto;
  }
}

@supports (backdrop-filter: blur(12px)) {
  .card,
  .dashboard-header,
  .dashboard-controls-bar {
    backdrop-filter: blur(12px);
  }
}
