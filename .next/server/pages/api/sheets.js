"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/sheets";
exports.ids = ["pages/api/sheets"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "xlsx":
/*!***********************!*\
  !*** external "xlsx" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("xlsx");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\sheets.js */ \"(api)/./pages/api/sheets.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/sheets\",\n        pathname: \"/api/sheets\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNoZWV0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDc2hlZXRzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaHJjLWRhc2hib2FyZC1hci8/OWEyMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHNoZWV0cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NoZWV0c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NoZWV0c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/sheets.js":
/*!*****************************!*\
  !*** ./pages/api/sheets.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xlsx */ \"xlsx\");\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n// Read and parse local Excel file located in repo root\nfunction readLocalExcel() {\n    const filePath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"Sawaedna_Geo_Progress_v2.xlsx\");\n    if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(filePath)) throw new Error(\"Local Excel file not found: \" + filePath);\n    const buffer = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(filePath);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_0___default().read(buffer, {\n        type: \"buffer\"\n    });\n    const sheetName = workbook.SheetNames[0];\n    const rows = xlsx__WEBPACK_IMPORTED_MODULE_0___default().utils.sheet_to_json(workbook.Sheets[sheetName], {\n        defval: null,\n        raw: false\n    });\n    return rows.filter((row)=>Object.values(row).some((v)=>v !== null && v !== undefined && v !== \"\"));\n}\nfunction normalizePercentCell(v) {\n    if (v == null) return 0;\n    if (typeof v === \"number\") return v > 1 ? v / 100 : v;\n    const s = String(v).trim().replace(\"%\", \"\").replace(\",\", \".\");\n    const n = parseFloat(s);\n    if (isNaN(n)) return 0;\n    return n > 1 ? n / 100 : n;\n}\nfunction generateSummary(data) {\n    const map = {};\n    data.forEach((r)=>{\n        const site = r[\"الموقع\"] || \"غير محدد\";\n        if (!map[site]) map[site] = {\n            planned: [],\n            actual: [],\n            lat: r.Latitude || r.latitude || null,\n            lng: r.Longitude || r.longitude || null\n        };\n        map[site].planned.push(normalizePercentCell(r[\"النسبة المخططة (%)\"]));\n        map[site].actual.push(normalizePercentCell(r[\"النسبة الفعلية (%)\"]));\n    });\n    return Object.entries(map).map(([site, v])=>({\n            \"الموقع\": site,\n            \"متوسط النسبة المخططة\": v.planned.length ? v.planned.reduce((a, b)=>a + b, 0) / v.planned.length : 0,\n            \"متوسط النسبة الفعلية\": v.actual.length ? v.actual.reduce((a, b)=>a + b, 0) / v.actual.length : 0,\n            \"Latitude\": v.lat,\n            \"Longitude\": v.lng\n        }));\n}\nfunction calculateProjectDates(data) {\n    const starts = data.map((r)=>r[\"تاريخ البداية\"]).filter(Boolean).map((d)=>new Date(d)).map((dt)=>dt.getTime());\n    const ends = data.map((r)=>r[\"تاريخ النهاية\"]).filter(Boolean).map((d)=>new Date(d)).map((dt)=>dt.getTime());\n    if (!starts.length || !ends.length) return {\n        totalDays: 0,\n        elapsed: 0,\n        remaining: 0\n    };\n    const start = Math.min(...starts);\n    const end = Math.max(...ends);\n    const totalDays = Math.ceil((end - start) / (1000 * 60 * 60 * 24));\n    const elapsed = Math.max(0, Math.ceil((Date.now() - start) / (1000 * 60 * 60 * 24)));\n    const remaining = Math.max(0, totalDays - elapsed);\n    return {\n        totalDays,\n        elapsed,\n        remaining\n    };\n}\nasync function handler(req, res) {\n    try {\n        // Always use local Excel for now (future: replace with Google Sheets API using service account)\n        const data = readLocalExcel();\n        const summary = generateSummary(data);\n        const geo = summary.filter((s)=>s.Latitude != null && s.Longitude != null);\n        const projectDates = calculateProjectDates(data);\n        return res.status(200).json({\n            data: {\n                detailed: data,\n                summary,\n                geo,\n                projectDates\n            }\n        });\n    } catch (err) {\n        console.error(\"sheets API error\", err);\n        return res.status(500).json({\n            error: err.message || String(err)\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNyRSxNQUFNK0IsZUFBZXZCLHNCQUFzQm5CO1FBQzNDLE9BQU91QyxJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUU1QyxNQUFNO2dCQUFFNkMsVUFBVTdDO2dCQUFNd0M7Z0JBQVNDO2dCQUFLQztZQUFhO1FBQUU7SUFDckYsRUFBRSxPQUFPSSxLQUFLO1FBQ1pDLFFBQVFDLEtBQUssQ0FBQyxvQkFBb0JGO1FBQ2xDLE9BQU9QLElBQUlJLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUksT0FBT0YsSUFBSUcsT0FBTyxJQUFJeEQsT0FBT3FEO1FBQUs7SUFDbEU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2hyYy1kYXNoYm9hcmQtYXIvLi9wYWdlcy9hcGkvc2hlZXRzLmpzPzA2MDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFhMU1ggZnJvbSAneGxzeCc7XHJcbmltcG9ydCBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5cclxuLy8gUmVhZCBhbmQgcGFyc2UgbG9jYWwgRXhjZWwgZmlsZSBsb2NhdGVkIGluIHJlcG8gcm9vdFxyXG5mdW5jdGlvbiByZWFkTG9jYWxFeGNlbCgpIHtcclxuICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnU2F3YWVkbmFfR2VvX1Byb2dyZXNzX3YyLnhsc3gnKTtcclxuICBpZiAoIWZzLmV4aXN0c1N5bmMoZmlsZVBhdGgpKSB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsIEV4Y2VsIGZpbGUgbm90IGZvdW5kOiAnICsgZmlsZVBhdGgpO1xyXG4gIGNvbnN0IGJ1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCk7XHJcbiAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoYnVmZmVyLCB7IHR5cGU6ICdidWZmZXInIH0pO1xyXG4gIGNvbnN0IHNoZWV0TmFtZSA9IHdvcmtib29rLlNoZWV0TmFtZXNbMF07XHJcbiAgY29uc3Qgcm93cyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3JrYm9vay5TaGVldHNbc2hlZXROYW1lXSwgeyBkZWZ2YWw6IG51bGwsIHJhdzogZmFsc2UgfSk7XHJcbiAgcmV0dXJuIHJvd3MuZmlsdGVyKHJvdyA9PiBPYmplY3QudmFsdWVzKHJvdykuc29tZSh2ID0+IHYgIT09IG51bGwgJiYgdiAhPT0gdW5kZWZpbmVkICYmIHYgIT09ICcnKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZVBlcmNlbnRDZWxsKHYpIHtcclxuICBpZiAodiA9PSBudWxsKSByZXR1cm4gMDtcclxuICBpZiAodHlwZW9mIHYgPT09ICdudW1iZXInKSByZXR1cm4gdiA+IDEgPyB2IC8gMTAwIDogdjtcclxuICBjb25zdCBzID0gU3RyaW5nKHYpLnRyaW0oKS5yZXBsYWNlKCclJywgJycpLnJlcGxhY2UoJywnLCAnLicpO1xyXG4gIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHMpO1xyXG4gIGlmIChpc05hTihuKSkgcmV0dXJuIDA7XHJcbiAgcmV0dXJuIG4gPiAxID8gbiAvIDEwMCA6IG47XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlU3VtbWFyeShkYXRhKSB7XHJcbiAgY29uc3QgbWFwID0ge307XHJcbiAgZGF0YS5mb3JFYWNoKHIgPT4ge1xyXG4gICAgY29uc3Qgc2l0ZSA9IHJbJ9in2YTZhdmI2YLYuSddIHx8ICfYutmK2LEg2YXYrdiv2K8nO1xyXG4gICAgaWYgKCFtYXBbc2l0ZV0pIG1hcFtzaXRlXSA9IHsgcGxhbm5lZDogW10sIGFjdHVhbDogW10sIGxhdDogci5MYXRpdHVkZSB8fCByLmxhdGl0dWRlIHx8IG51bGwsIGxuZzogci5Mb25naXR1ZGUgfHwgci5sb25naXR1ZGUgfHwgbnVsbCB9O1xyXG4gICAgbWFwW3NpdGVdLnBsYW5uZWQucHVzaChub3JtYWxpemVQZXJjZW50Q2VsbChyWyfYp9mE2YbYs9io2Kkg2KfZhNmF2K7Yt9i32KkgKCUpJ10pKTtcclxuICAgIG1hcFtzaXRlXS5hY3R1YWwucHVzaChub3JtYWxpemVQZXJjZW50Q2VsbChyWyfYp9mE2YbYs9io2Kkg2KfZhNmB2LnZhNmK2KkgKCUpJ10pKTtcclxuICB9KTtcclxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMobWFwKS5tYXAoKFtzaXRlLCB2XSkgPT4gKHtcclxuICAgICfYp9mE2YXZiNmC2LknOiBzaXRlLFxyXG4gICAgJ9mF2KrZiNiz2Lcg2KfZhNmG2LPYqNipINin2YTZhdiu2LfYt9ipJzogdi5wbGFubmVkLmxlbmd0aCA/IHYucGxhbm5lZC5yZWR1Y2UoKGEsYik9PmErYiwwKS92LnBsYW5uZWQubGVuZ3RoIDogMCxcclxuICAgICfZhdiq2YjYs9i3INin2YTZhtiz2KjYqSDYp9mE2YHYudmE2YrYqSc6IHYuYWN0dWFsLmxlbmd0aCA/IHYuYWN0dWFsLnJlZHVjZSgoYSxiKT0+YStiLDApL3YuYWN0dWFsLmxlbmd0aCA6IDAsXHJcbiAgICAnTGF0aXR1ZGUnOiB2LmxhdCxcclxuICAgICdMb25naXR1ZGUnOiB2LmxuZ1xyXG4gIH0pKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlUHJvamVjdERhdGVzKGRhdGEpIHtcclxuICBjb25zdCBzdGFydHMgPSBkYXRhLm1hcChyID0+IHJbJ9iq2KfYsdmK2K4g2KfZhNio2K/Yp9mK2KknXSkuZmlsdGVyKEJvb2xlYW4pLm1hcChkID0+IG5ldyBEYXRlKGQpKS5tYXAoZHQgPT4gZHQuZ2V0VGltZSgpKTtcclxuICBjb25zdCBlbmRzID0gZGF0YS5tYXAociA9PiByWyfYqtin2LHZitiuINin2YTZhtmH2KfZitipJ10pLmZpbHRlcihCb29sZWFuKS5tYXAoZCA9PiBuZXcgRGF0ZShkKSkubWFwKGR0ID0+IGR0LmdldFRpbWUoKSk7XHJcbiAgaWYgKCFzdGFydHMubGVuZ3RoIHx8ICFlbmRzLmxlbmd0aCkgcmV0dXJuIHsgdG90YWxEYXlzOiAwLCBlbGFwc2VkOiAwLCByZW1haW5pbmc6IDAgfTtcclxuICBjb25zdCBzdGFydCA9IE1hdGgubWluKC4uLnN0YXJ0cyk7IGNvbnN0IGVuZCA9IE1hdGgubWF4KC4uLmVuZHMpO1xyXG4gIGNvbnN0IHRvdGFsRGF5cyA9IE1hdGguY2VpbCgoZW5kIC0gc3RhcnQpLygxMDAwKjYwKjYwKjI0KSk7XHJcbiAgY29uc3QgZWxhcHNlZCA9IE1hdGgubWF4KDAsIE1hdGguY2VpbCgoRGF0ZS5ub3coKSAtIHN0YXJ0KS8oMTAwMCo2MCo2MCoyNCkpKTtcclxuICBjb25zdCByZW1haW5pbmcgPSBNYXRoLm1heCgwLCB0b3RhbERheXMgLSBlbGFwc2VkKTtcclxuICByZXR1cm4geyB0b3RhbERheXMsIGVsYXBzZWQsIHJlbWFpbmluZyB9O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEFsd2F5cyB1c2UgbG9jYWwgRXhjZWwgZm9yIG5vdyAoZnV0dXJlOiByZXBsYWNlIHdpdGggR29vZ2xlIFNoZWV0cyBBUEkgdXNpbmcgc2VydmljZSBhY2NvdW50KVxyXG4gICAgY29uc3QgZGF0YSA9IHJlYWRMb2NhbEV4Y2VsKCk7XHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gZ2VuZXJhdGVTdW1tYXJ5KGRhdGEpO1xyXG4gICAgY29uc3QgZ2VvID0gc3VtbWFyeS5maWx0ZXIocyA9PiBzLkxhdGl0dWRlICE9IG51bGwgJiYgcy5Mb25naXR1ZGUgIT0gbnVsbCk7XHJcbiAgICBjb25zdCBwcm9qZWN0RGF0ZXMgPSBjYWxjdWxhdGVQcm9qZWN0RGF0ZXMoZGF0YSk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBkYXRhOiB7IGRldGFpbGVkOiBkYXRhLCBzdW1tYXJ5LCBnZW8sIHByb2plY3REYXRlcyB9IH0pO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcignc2hlZXRzIEFQSSBlcnJvcicsIGVycik7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyLm1lc3NhZ2UgfHwgU3RyaW5nKGVycikgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiWExTWCIsImZzIiwicGF0aCIsInJlYWRMb2NhbEV4Y2VsIiwiZmlsZVBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImV4aXN0c1N5bmMiLCJFcnJvciIsImJ1ZmZlciIsInJlYWRGaWxlU3luYyIsIndvcmtib29rIiwicmVhZCIsInR5cGUiLCJzaGVldE5hbWUiLCJTaGVldE5hbWVzIiwicm93cyIsInV0aWxzIiwic2hlZXRfdG9fanNvbiIsIlNoZWV0cyIsImRlZnZhbCIsInJhdyIsImZpbHRlciIsInJvdyIsIk9iamVjdCIsInZhbHVlcyIsInNvbWUiLCJ2IiwidW5kZWZpbmVkIiwibm9ybWFsaXplUGVyY2VudENlbGwiLCJzIiwiU3RyaW5nIiwidHJpbSIsInJlcGxhY2UiLCJuIiwicGFyc2VGbG9hdCIsImlzTmFOIiwiZ2VuZXJhdGVTdW1tYXJ5IiwiZGF0YSIsIm1hcCIsImZvckVhY2giLCJyIiwic2l0ZSIsInBsYW5uZWQiLCJhY3R1YWwiLCJsYXQiLCJMYXRpdHVkZSIsImxhdGl0dWRlIiwibG5nIiwiTG9uZ2l0dWRlIiwibG9uZ2l0dWRlIiwicHVzaCIsImVudHJpZXMiLCJsZW5ndGgiLCJyZWR1Y2UiLCJhIiwiYiIsImNhbGN1bGF0ZVByb2plY3REYXRlcyIsInN0YXJ0cyIsIkJvb2xlYW4iLCJkIiwiRGF0ZSIsImR0IiwiZ2V0VGltZSIsImVuZHMiLCJ0b3RhbERheXMiLCJlbGFwc2VkIiwicmVtYWluaW5nIiwic3RhcnQiLCJNYXRoIiwibWluIiwiZW5kIiwibWF4IiwiY2VpbCIsIm5vdyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzdW1tYXJ5IiwiZ2VvIiwicHJvamVjdERhdGVzIiwic3RhdHVzIiwianNvbiIsImRldGFpbGVkIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/sheets.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();